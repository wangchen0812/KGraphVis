<!-- src/components/SystemIntroduction.vue -->
<template>
  <!-- ç³»ç»Ÿç®€ä»‹è¦†ç›–é¡µé¢ -->
  <div v-if="showIntroduction" class="system-introduction-overlay">
    <div class="introduction-content">
      <div class="content-wrapper">
        <!-- æ ‡é¢˜åŒºåŸŸ -->
        <div class="title-section">
          <h1 class="main-title">æ–°å››å†›äº”å¸ˆçº¢è‰²ä¿¡æ¯å›¾è°±</h1>
          <div class="title-decoration"></div>
        </div>

        <!-- å†…å®¹åŒºåŸŸ - åŒæ å¸ƒå±€ -->
        <div class="content-grid">
          <!-- å·¦ä¾§ï¼šæ–°å››å†›ç¬¬äº”å¸ˆç®€ä»‹ -->
          <div class="content-column">
            <div class="intro-card">
              <div class="card-header">
                <h2 class="section-title">æ–°å››å†›ç¬¬äº”å¸ˆ</h2>
                <span class="section-badge">è¿‘ä»£å†›äº‹éƒ¨é˜Ÿ</span>
              </div>
              <div class="card-content">
                <div class="highlight-text">ä¸­å›½å…±äº§å…šé¢†å¯¼ä¸‹çš„ä¸€æ”¯é‡è¦æŠ—æ—¥æ­¦è£…åŠ›é‡ï¼Œæˆç«‹äºæŠ—æ—¥æˆ˜äº‰æ—¶æœŸã€‚</div>
                <ul class="feature-list">
                  <li>ä¸»è¦ç”±æ¹–åŒ—ã€æ²³å—ã€å®‰å¾½ç­‰åœ°çš„çº¢å†›æ¸¸å‡»é˜Ÿå’ŒæŠ—æ—¥ä¹‰å‹‡å†›ç»„æˆï¼Œåæ¥å‘å±•æˆä¸ºæ–°å››å†›çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ç¬¬äº”å¸ˆåœ¨æŠ—æ—¥æˆ˜äº‰ä¸­è‹±å‹‡ä½œæˆ˜ï¼Œä¸ºä¸­å›½äººæ°‘çš„è§£æ”¾äº‹ä¸šä½œå‡ºäº†é‡è¦è´¡çŒ®ã€‚</li>
                  <li> äº”å¸ˆä¸»è¦é¢†å¯¼äººæ˜¯æå…ˆå¿µï¼Œä»–åœ¨æŠ—æ—¥æˆ˜äº‰å’Œè§£æ”¾æˆ˜äº‰ä¸­å‘æŒ¥äº†é‡è¦ä½œç”¨ã€‚äº”å¸ˆåœ¨æ•Œåå¼€å±•æ¸¸å‡»æˆ˜äº‰ï¼Œæœ‰æ•ˆåœ°æ‰“å‡»äº†æ—¥æœ¬ä¾µç•¥è€…ï¼Œä¿æŠ¤äº†äººæ°‘ç¾¤ä¼—ç”Ÿå‘½è´¢äº§å®‰å…¨ï¼Œä¸ºä¸­å›½å…±äº§å…šåœ¨åä¸­åœ°åŒºçš„å‘å±•å¥ å®šäº†åŸºç¡€ã€‚
                  </li>
                  <li> æŠ—æ—¥æˆ˜äº‰èƒœåˆ©åï¼Œæ–°å››å†›äº”å¸ˆç»§ç»­å‚ä¸è§£æ”¾æˆ˜äº‰ï¼Œä¸ºä¸­å›½äººæ°‘çš„è§£æ”¾äº‹ä¸šå¥‹æ–—ã€‚1949å¹´ä¸­åäººæ°‘å…±å’Œå›½æˆç«‹åï¼Œäº”å¸ˆè®¸å¤šæˆå‘˜æˆä¸ºæ–°ä¸­å›½å»ºè®¾å’Œå›½é˜²é‡è¦åŠ›é‡ã€‚
                  </li>
                  <li> æ–°å››å†›äº”å¸ˆå†å²æ˜¯ä¸­å›½é©å‘½å²ä¸€éƒ¨åˆ†ï¼Œå®ƒçš„è‹±å‹‡äº‹è¿¹å’Œç‰ºç‰²ç²¾ç¥æ°¸è¿œé“­è®°åœ¨ä¸­å›½äººæ°‘å¿ƒä¸­ã€‚
                  </li>
                </ul>

                <!-- <button class="audio-play-btn" @click="playIntroAudio" title="æ’­æ”¾ç®€ä»‹éŸ³é¢‘">
                  <Volume2 :size="18" />
                  <span>æ’­æ”¾</span>
                </button> -->

                <button class="audio-play-btn" @click="toggleIntroAudio('wushi')" :title="wushiPlaying ? 'æš‚åœ' : 'æ’­æ”¾'">
                  <PauseCircle v-if="wushiPlaying" :size="18" />
                  <Volume2 v-else :size="18" />
                  <span>{{ wushiPlaying ? 'æš‚åœ' : 'æ’­æ”¾' }}</span>
                </button>
              </div>
            </div>
          </div>

          <!-- å³ä¾§ï¼šç³»ç»Ÿç®€ä»‹ -->
          <div class="content-column">
            <div class="intro-card">
              <div class="card-header">
                <h2 class="section-title">ç³»ç»ŸåŠŸèƒ½</h2>
                <span class="section-badge">çŸ¥è¯†å›¾è°±</span>
              </div>
              <div class="card-content">
                <div class="highlight-text">
                  æ„å»ºå¯äº¤äº’çŸ¥è¯†å›¾è°±ï¼Œä¾¿æ·æŸ¥è¯¢å†å²å…³ç³»ã€‚
                </div>
                <ul class="feature-list">
                  <li>
                    ç³»ç»Ÿé€šè¿‡<b>åŒ—äº¬æ–°å››å†›ç ”ç©¶ä¼šäº”å¸ˆåˆ†ä¼šä¼šå‘˜è‡ªæ„¿å¡«å†™è°ƒæŸ¥é—®å·ã€å…¬å¼€å‡ºç‰ˆç‰©å’Œç™¾åº¦ç™¾ç§‘ç­‰ç›¸å¯¹å¯é </b>çš„å½¢å¼æ”¶é›†æ–°å››å†›äº”å¸ˆå‰è¾ˆä¿¡æ¯ã€åŒ…æ‹¬æ•™è‚²ä¸å·¥ä½œç»å†ã€å‚åŠ æˆ˜å½¹æˆ˜æ–—ç­‰ï¼Œæ„å»ºå¯äº¤äº’çŸ¥è¯†å›¾è°±ï¼Œä¾¿æ·æŸ¥è¯¢"æˆ˜å‹ã€åŒä¹¡ã€æˆ˜å½¹"ç­‰å…³ç³»ï¼Œä¸ºæ–°å››å†›äº”å¸ˆé©å‘½å†å²ç ”ç©¶æä¾›è¾…åŠ©å·¥å…·ã€‚
                  </li>
                  <li>
                    æ”¯æŒè¾“å…¥äººç‰©çš„å§“åæŸ¥è¯¢äººç‰©å…³ç³»ã€æ•™è‚²ä¸å·¥ä½œç»å†ã€å‚ä¸çš„æˆ˜å½¹æˆ˜æ–—ã€‚
                  </li>
                  <li>
                    è¾“å…¥æˆ˜å½¹æˆ˜æ–—çš„åç§°æŸ¥çœ‹å…±åŒå‚ä¸çš„äººç‰©ã€‚
                  </li>
                  <li>
                    å›¾è°±å¯å±•ç¤ºã€å¯äº¤äº’ï¼Œæä¾›æ—¶é—´è½´è¿‡æ»¤ã€å±æ€§è¯¦æƒ…å±•ç¤ºåŠŸèƒ½ã€‚
                  </li>
                  <li>
                    æä¾›æ™ºèƒ½é—®ç­”ï¼Œå¯è¿”å›å›¾è°±å­å›¾ï¼Œä¹Ÿå¯æä¾›è‡ªç„¶è¯­è¨€ç­”æ¡ˆã€‚
                  </li>
                </ul>

                <button class="audio-play-btn" @click="toggleIntroAudio('system')" :title="systemPlaying ? 'æš‚åœ' : 'æ’­æ”¾'">
                  <PauseCircle v-if="systemPlaying" :size="18" />
                  <Volume2 v-else :size="18" />
                  <span>{{ systemPlaying ? 'æš‚åœ' : 'æ’­æ”¾' }}</span>
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- æŒ‰é’®åŒºåŸŸ -->
        <div class="button-section">
          <button class="enter-system-btn" @click="enterSystem">
            <span class="btn-text">è¿›å…¥ç³»ç»Ÿ</span>
            <span class="btn-icon">â†’</span>
          </button>
          <p class="btn-subtitle">æ¢ç´¢æ–°å››å†›ç¬¬äº”å¸ˆé©å‘½å†å²</p>
        </div>
      </div>
    </div>
  </div>

  <!-- å³ä¸‹è§’å°å›¾æ ‡ -->
  <div v-if="!showIntroduction" class="floating-icon" @click="showIntroduction = true" title="æŸ¥çœ‹ç³»ç»Ÿç®€ä»‹">
    <BookOpen :size="18" />
  </div>
</template>

<script setup>
import { ref } from 'vue'
import { BookOpen, Volume2, PauseCircle } from 'lucide-vue-next'

/* å“åº”å¼æ•°æ® */
const showIntroduction = ref(true)

/* æ–¹æ³• */
function enterSystem() {
  showIntroduction.value = false
  audioWushi.currentTime = 0;
  audioWushi.pause()
  wushiPlaying.value = false
  
  audioSystem.currentTime = 0;
  audioSystem.pause()
  systemPlaying.value = false
}

// /* æ’­æ”¾éŸ³é¢‘ */
// const introAudioUrl = new URL('../assets/audio/æ–°å››å†›äº”å¸ˆä»‹ç».mp3', import.meta.url).href
// function playIntroAudio() {
//   const audio = new Audio(introAudioUrl)
//   audio.play().catch(() => alert('éŸ³é¢‘åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„'))
// }

/* ---------- éŸ³é¢‘ ---------- */
const audioWushi = new Audio(new URL('../assets/audio/æ–°å››å†›äº”å¸ˆä»‹ç».mp3', import.meta.url).href)
const audioSystem = new Audio(new URL('../assets/audio/ç³»ç»ŸåŠŸèƒ½ä»‹ç».mp3', import.meta.url).href)

/* å„å¡ç‰‡ç‹¬ç«‹çš„æ’­æ”¾çŠ¶æ€ */
const wushiPlaying = ref(false)
const systemPlaying = ref(false)

/* æ’­æ”¾/æš‚åœ */
function toggleIntroAudio(label) {
  if (label === 'wushi') {
    if (wushiPlaying.value) {
      audioWushi.pause()
    } else {
      audioWushi.play().catch(() => alert('éŸ³é¢‘åŠ è½½å¤±è´¥'))
    }
    wushiPlaying.value = !wushiPlaying.value
    // ä¿è¯å¦ä¸€æ”¯ä¸€å®šåœæ­¢
    if (systemPlaying.value) {
      audioSystem.pause()
      systemPlaying.value = false
    }
  }

  if (label === 'system') {
    if (systemPlaying.value) {
      audioSystem.pause()
    } else {
      audioSystem.play().catch(() => alert('éŸ³é¢‘åŠ è½½å¤±è´¥'))
    }
    systemPlaying.value = !systemPlaying.value
    if (wushiPlaying.value) {
      audioWushi.pause()
      wushiPlaying.value = false
    }
  }
}



</script>

<style scoped>
.system-introduction-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: url('../assets/èƒŒæ™¯1.jpg');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  backdrop-filter: blur(1px);
  overflow: hidden;
}

.introduction-content {
  width: min(90vw, 1400px);
  height: min(100vh, 900px);
  background: rgba(255, 255, 255, 0);
  border-radius: clamp(10px, 2vw, 20px);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.content-wrapper {
  /* padding: clamp(10px, 2vh, 20px) clamp(10px, 2vw, 30px); */
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  gap: clamp(10px, 2vh, 20px);
}

/* æ ‡é¢˜åŒºåŸŸ */
.title-section {
  text-align: center;
  flex-shrink: 0;
}

.main-title {
  font-size: clamp(1.5rem, 4vw, 2.5rem);
  font-weight: bold;
  color: #2c1810;
  margin-bottom: clamp(8px, 1.5vh, 15px);
  text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.8);
  line-height: 1.2;
}

.title-decoration {
  width: clamp(100px, 20vw, 200px);
  height: clamp(2px, 0.5vh, 4px);
  background: linear-gradient(90deg, transparent, #8B4513, transparent);
  margin: 0 auto;
  border-radius: 2px;
}

/* å†…å®¹ç½‘æ ¼ */
.content-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: clamp(15px, 3vw, 30px);
  flex: 1;
  min-height: 0;
  /* å…è®¸å†…å®¹æ”¶ç¼© */
}

.content-column {
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.intro-card {
  background: rgba(255, 248, 220, 0.65);
  border-radius: clamp(8px, 1.5vw, 15px);
  border: 2px solid rgba(139, 69, 19, 0.3);
  height: 100%;
  display: flex;
  flex-direction: column;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  min-height: 0;
  overflow: hidden;
}

.card-header {
  padding: clamp(15px, 2.5vh, 25px) clamp(15px, 2.5vw, 25px) clamp(10px, 1.5vh, 15px);
  border-bottom: 2px solid rgba(139, 69, 19, 0.2);
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-shrink: 0;
  flex-wrap: wrap;
  gap: 10px;
}

.section-title {
  font-size: clamp(1.2rem, 2.5vw, 1.6rem);
  font-weight: bold;
  color: #2C1810;
  margin: 0;
  line-height: 1.2;
}

.section-badge {
  background: linear-gradient(135deg, #8B4513, #CD853F);
  color: white;
  padding: clamp(3px, 0.5vh, 5px) clamp(8px, 1.5vw, 12px);
  border-radius: 20px;
  font-size: clamp(0.7rem, 1.5vw, 0.8rem);
  font-weight: 500;
  white-space: nowrap;
}

.card-content {
  padding: clamp(15px, 2.5vh, 25px);
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  min-height: 0;
}

.highlight-text {
  font-size: clamp(0.9rem, 2vw, 1.1rem);
  font-weight: 600;
  color: #2C1810;
  margin-bottom: clamp(8px, 1.5vh, 15px);
  padding: clamp(8px, 1.5vh, 12px);
  background: rgba(222, 184, 135, 0.4);
  border-radius: clamp(6px, 1vw, 10px);
  border-left: 4px solid #8B4513;
  line-height: 1.4;
  flex-shrink: 0;
}

.feature-list {
  list-style: none;
  padding: 0;
  margin: 0;
  flex: 1;
  overflow-y: auto;
}

.feature-list li {
  padding: clamp(6px, 1vh, 10px) 0;
  color: #2C1810;
  font-size: clamp(0.8rem, 1.8vw, 1rem);
  position: relative;
  padding-left: clamp(16px, 3vw, 20px);
  line-height: 1.5;
  margin-bottom: clamp(4px, 0.8vh, 8px);
}

.feature-list li::before {
  content: "â˜…";
  color: #8B4513;
  font-weight: bold;
  position: absolute;
  left: 0;
  top: clamp(6px, 1vh, 10px);
}

/* æŒ‰é’®åŒºåŸŸ */
.button-section {
  text-align: center;
  padding-top: clamp(10px, 2vh, 20px);
  border-top: 2px solid rgba(139, 69, 19, 0.2);
  flex-shrink: 0;
}

.enter-system-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: clamp(8px, 1.5vw, 12px);
  padding: clamp(12px, 2vh, 15px) clamp(25px, 5vw, 40px);
  background: linear-gradient(135deg, #8B4513, #CD853F);
  color: white;
  border: none;
  border-radius: 50px;
  font-size: clamp(1rem, 2.2vw, 1.3rem);
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 8px 25px rgba(139, 69, 19, 0.4);
  margin-bottom: clamp(5px, 1vh, 10px);
}

.enter-system-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 35px rgba(139, 69, 19, 0.5);
  background: linear-gradient(135deg, #A0522D, #DEB887);
}

.btn-text {
  font-size: clamp(0.9rem, 2vw, 1.2rem);
}

.btn-icon {
  font-size: clamp(1.1rem, 2.2vw, 1.4rem);
  transition: transform 0.3s ease;
}

.enter-system-btn:hover .btn-icon {
  transform: translateX(3px);
}

.btn-subtitle {
  color: #000;
  font-size: clamp(0.7rem, 1.6vw, 0.9rem);
  margin: 0;
  font-style: italic;
  line-height: 1.3;
}

.floating-icon {
  position: fixed;
  bottom: clamp(10px, 4vh, 20px);
  right: clamp(20px, 4vw, 30px);
  width: clamp(35px, 8vw, 40px);
  height: clamp(35px, 8vw, 40px);
  background: linear-gradient(135deg, #8B4513, #CD853F);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 8px 25px rgba(139, 69, 19, 0.4);
  transition: all 0.3s ease;
  z-index: 1000;
  color: white;
}

.floating-icon:hover {
  transform: scale(1.1);
  box-shadow: 0 12px 35px rgba(139, 69, 19, 0.5);
}

.floating-icon svg {
  width: clamp(20px, 4vw, 28px);
  height: clamp(20px, 4vw, 28px);
}

/* å“åº”å¼æ–­ç‚¹ */
@media (max-width: 1200px) {
  .content-grid {
    gap: clamp(10px, 2vw, 20px);
  }
}

@media (max-width: 900px) {
  .content-grid {
    grid-template-columns: 1fr;
    gap: clamp(15px, 2vh, 20px);
  }

  .card-header {
    flex-direction: column;
    align-items: flex-start;
    text-align: left;
  }

  .section-badge {
    align-self: flex-start;
  }
}

@media (max-width: 600px) {
  .introduction-content {
    width: 98vw;
    height: 100vh;
  }

  .content-wrapper {
    padding: clamp(8px, 1.5vh, 15px) clamp(8px, 2vw, 15px);
  }

  .card-content {
    padding: clamp(10px, 2vh, 15px);
  }

  .feature-list li {
    font-size: clamp(0.75rem, 3.5vw, 0.9rem);
  }
}

@media (max-height: 600px) {
  .introduction-content {
    height: 100vh;
  }

  .content-wrapper {
    gap: clamp(5px, 1vh, 10px);
  }

  .title-section {
    margin-bottom: 0;
  }

  .main-title {
    margin-bottom: clamp(5px, 1vh, 10px);
  }

  .card-content {
    padding: clamp(10px, 1.5vh, 15px);
  }

  .button-section {
    padding-top: clamp(5px, 1vh, 10px);
  }
}

/* è¶…å°å±å¹•ä¼˜åŒ– */
@media (max-width: 400px) {
  .feature-list li {
    padding-left: 15px;
    font-size: 0.75rem;
  }

  .highlight-text {
    font-size: 0.85rem;
    padding: 8px;
  }
}

/* æ»šåŠ¨æ¡æ ·å¼ */
.card-content::-webkit-scrollbar,
.feature-list::-webkit-scrollbar {
  width: 4px;
}

.card-content::-webkit-scrollbar-track,
.feature-list::-webkit-scrollbar-track {
  background: rgba(139, 69, 19, 0.1);
  border-radius: 2px;
}

.card-content::-webkit-scrollbar-thumb,
.feature-list::-webkit-scrollbar-thumb {
  background: rgba(139, 69, 19, 0.4);
  border-radius: 2px;
}

.card-content::-webkit-scrollbar-thumb:hover,
.feature-list::-webkit-scrollbar-thumb:hover {
  background: rgba(139, 69, 19, 0.6);
}


/* æ’­æ”¾æŒ‰é’®ï¼šå›ºå®šåœ¨å¡ç‰‡å³ä¸‹è§’ */
.audio-play-btn {
  position: absolute;
  bottom: 12px;
  right: 12px;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 6px 10px;
  background: rgba(139, 69, 19, 0.8);
  color: #fff;
  border: none;
  border-radius: 16px;
  font-size: 0.75rem;
  cursor: pointer;
  transition: background 0.3s ease;
}

.audio-play-btn:hover {
  background: rgba(160, 82, 45, 0.95);
}

/* è®© card-content æˆä¸ºå®šä½å‚ç…§ */
.card-content {
  position: relative;
}
</style>

<!-- <div class="highlight-text">
                  ä¸­å›½å…±äº§å…šé¢†å¯¼ä¸‹çš„é‡è¦æŠ—æ—¥æ­¦è£…åŠ›é‡ï¼Œä¸»è¦é¢†å¯¼äººæå…ˆå¿µ
                </div>
                <ul class="feature-list">
                  <li>ç”±æ¹–åŒ—ã€æ²³å—ã€å®‰å¾½ç­‰åœ°çº¢å†›æ¸¸å‡»é˜Ÿç»„æˆ</li>
                  <li>åœ¨æ•Œåå¼€å±•æ¸¸å‡»æˆ˜äº‰ï¼Œæœ‰æ•ˆæ‰“å‡»æ—¥æœ¬ä¾µç•¥è€…</li>
                  <li>ä¸ºåä¸­åœ°åŒºå‘å±•å¥ å®šé‡è¦åŸºç¡€</li>
                  <li>è‹±å‹‡äº‹è¿¹æ°¸è¿œé“­è®°åœ¨ä¸­å›½äººæ°‘å¿ƒä¸­</li>
                </ul> -->

<!-- <div class="features-grid">
                  <div class="feature-item">
                    <div class="feature-icon">ğŸ‘¥</div>
                    <div class="feature-name">äººç‰©å…³ç³»</div>
                  </div>
                  <div class="feature-item">
                    <div class="feature-icon">ğŸ“</div>
                    <div class="feature-name">æ•™è‚²ç»å†</div>
                  </div>
                  <div class="feature-item">
                    <div class="feature-icon">âš”ï¸</div>
                    <div class="feature-name">æˆ˜å½¹æˆ˜æ–—</div>
                  </div>
                  <div class="feature-item">
                    <div class="feature-icon">ğŸ¤–</div>
                    <div class="feature-name">æ™ºèƒ½é—®ç­”</div>
                  </div>
                </div> -->
